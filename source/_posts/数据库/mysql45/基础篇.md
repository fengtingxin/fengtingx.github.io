---
title: 基础篇
date: 2024-09-21 16:47:34
categories:
  - Mysql
  - 待完成
tags:
  - MqSQL实战45讲
cover: true
summary: mysql基础篇
---

# 事务

MyISAM不支持事务；InnoDB支持事务.

介绍一下事务的AICD特性：（Atomicity、Consistency、Isolation、Durability）

A（Atomicity）：原子性，就是说在一个事务内是一个不可分割的操作单元，要么全部执行成功，要么全部失败回滚。这保证了数据的一致性和完整性。

C（Consistency）：一致性，事务执行前后，数据库的状态必须保持一致。事务的操作应满足预定义的约束和规则，不会破坏数据的完整性。在分布式系统中，可以理解为多个节点中数据的值是一致的。

I（Isolation）：隔离性，并发执行的事务之间要相互隔离，互不干扰。每个事务都应该感觉不到其他事务的存在，避免数据冲突和干扰。

D（Durability）：持久性，一旦事务提交成功，对数据库的修改就是永久性的，即使系统发生故障或重启，修改的数据也能恢复。

## 隔离性

事务的隔离级别：

| 隔离级别                     | 介绍                                                         |
| ---------------------------- | ------------------------------------------------------------ |
| 读未提交（read uncommitted） | 一个事务还没提交时，它做的变更就能被别的事务看到。           |
| 读提交（read committed）     | 一个事务提交之后，它做的变更才会被其他事务看到。             |
| 可重复读（repeatable read）  | Innodb的默认隔离级别<br />一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的。当然在可重复读隔离级别下，未提交变更对其他事务也是不可见的。 |
| 串行化（serializable ）      | 顾名思义是对于同一行记录，“写”会加“写锁”，“读”会加“读锁”。当出现读写锁冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行。 |



举例：

```sql
mysql> create table T(c int) engine=InnoDB;
insert into T(c) values(1);
```

![1](/2024/09/21/shu-ju-ku/mysql45/ji-chu-pian/1.png)

| 隔离级别                     | V1、V2、V3的结果 |
| ---------------------------- | ---------------- |
| 读未提交（read uncommitted） | V1=2；V2=2；V3=2 |
| 读提交（read committed）     | V1=1；V2=2；V3=2 |
| 可重复读（repeatable read）  | V1=1；V2=1；V3=2 |
| 串行化（serializable ）      | V1=1；V2=1；V3=2 |

隔离级别为可重复读的实现方式：多版本并发控制-MVCC

> InnoDB通过为每一行记录添加两个额外的隐藏的值来实现MVCC，这两个值一个记录这行数据何时被创建，另外一个记录这行数据何时过期（或者被删除）。但是InnoDB并不存储这些事件发生时的实际时间，相反它只存储这些事件发生时的系统版本号（LSN）。这是一个随着事务的创建而不断增长的数字。每个事务在事务开始时会记录它自己的系统版本号。每个查询必须去检查每行数据的版本号与事务的版本号是否相同。

# 索引

索引的常见模型

| 模型     | 简介                                                         |
| -------- | ------------------------------------------------------------ |
| 哈希表   | 以键 - 值（key-value）存储数据的结构；不可避免地，多个 key 值经过哈希函数的换算，会出现同一个值的情况。处理这种情况的一种方法是拉出一个链表。(hashMap的处理方案) |
| 有序数组 |                                                              |
| 搜索树   |                                                              |

